var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(p){var H=0;return function(){return H<p.length?{done:!1,value:p[H++]}:{done:!0}}};$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,H,x){if(p==Array.prototype||p==Object.prototype)return p;p[H]=x.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var H=0;H<p.length;++H){var x=p[H];if(x&&x.Math==Math)return x}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,H){var x=$jscomp.propertyToPolyfillSymbol[H];if(null==x)return p[H];x=p[x];return void 0!==x?x:p[H]};
$jscomp.polyfill=function(p,H,x,B){H&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,H,x,B):$jscomp.polyfillUnisolated(p,H,x,B))};$jscomp.polyfillUnisolated=function(p,H,x,B){x=$jscomp.global;p=p.split(".");for(B=0;B<p.length-1;B++){var w=p[B];if(!(w in x))return;x=x[w]}p=p[p.length-1];B=x[p];H=H(B);H!=B&&null!=H&&$jscomp.defineProperty(x,p,{configurable:!0,writable:!0,value:H})};
$jscomp.polyfillIsolated=function(p,H,x,B){var w=p.split(".");p=1===w.length;B=w[0];B=!p&&B in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var C=0;C<w.length-1;C++){var F=w[C];if(!(F in B))return;B=B[F]}w=w[w.length-1];x=$jscomp.IS_SYMBOL_NATIVE&&"es6"===x?B[w]:null;H=H(x);null!=H&&(p?$jscomp.defineProperty($jscomp.polyfills,w,{configurable:!0,writable:!0,value:H}):H!==x&&(void 0===$jscomp.propertyToPolyfillSymbol[w]&&(x=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[w]=$jscomp.IS_SYMBOL_NATIVE?
    $jscomp.global.Symbol(w):$jscomp.POLYFILL_PREFIX+x+"$"+w),$jscomp.defineProperty(B,$jscomp.propertyToPolyfillSymbol[w],{configurable:!0,writable:!0,value:H})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(p){if(p)return p;var H=function(C,F){this.$jscomp$symbol$id_=C;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:F})};H.prototype.toString=function(){return this.$jscomp$symbol$id_};var x="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",B=0,w=function(C){if(this instanceof w)throw new TypeError("Symbol is not a constructor");return new H(x+(C||"")+"_"+B++,C)};return w},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(p){if(p)return p;p=Symbol("Symbol.iterator");for(var H="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),x=0;x<H.length;x++){var B=$jscomp.global[H[x]];"function"===typeof B&&"function"!=typeof B.prototype[p]&&$jscomp.defineProperty(B.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return p},"es6",
    "es3");$jscomp.iteratorPrototype=function(p){p={next:p};p[Symbol.iterator]=function(){return this};return p};
(function(p){"object"===typeof exports&&"undefined"!==typeof module?module.exports=p():"function"===typeof define&&define.amd?define([],p):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).ImageModule=p()})(function(){return function(){function p(H,x,B){function w(z,E){if(!x[z]){if(!H[z]){var G="function"==typeof require&&require;if(!E&&G)return G(z,!0);if(C)return C(z,!0);G=Error("Cannot find module '"+z+"'");throw G.code="MODULE_NOT_FOUND",
    G;}G=x[z]={exports:{}};H[z][0].call(G.exports,function(g){return w(H[z][1][g]||g)},G,G.exports,p,H,x,B)}return x[z].exports}for(var C="function"==typeof require&&require,F=0;F<B.length;F++)w(B[F]);return w}return p}()({"/js/index.js":[function(p,H,x){function B(m){return m.part}function w(m){var c=m.part;m=m.postparsed.slice(m.left+1,m.right).reduce(function(t,e){return t+e.value},"");var n=(new G).parseFromString("<xml>"+m+"</xml>");c.offset={x:0,y:0};c.ext={cx:0,cy:0};m=n.getElementsByTagName("a:off");
        n=n.getElementsByTagName("a:ext");0<n.length&&(c.ext.cx=parseInt(n[n.length-1].getAttribute("cx"),10),c.ext.cy=parseInt(n[n.length-1].getAttribute("cy"),10));0<m.length&&(c.offset.x=parseInt(m[m.length-1].getAttribute("x"),10),c.offset.y=parseInt(m[m.length-1].getAttribute("y"),10));return c}var C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"===typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},
        F=function(){function m(c,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(c,e.key,e)}}return function(c,n,t){n&&m(c.prototype,n);t&&m(c,t);return c}}(),z=p("./templates"),E=p("docxtemplater").DocUtils,G=p("xmldom").DOMParser,g=p("./imgManager");p=function(){function m(c){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");this.name="ImageModule";this.options=c||{};this.imgManagers=
        {};null==this.options.centered&&(this.options.centered=!1);if(null==this.options.getImage)throw Error("You should pass getImage");if(null==this.options.getSize)throw Error("You should pass getSize");this.imageNumber=1}F(m,[{key:"optionsTransformer",value:function(c,n){var t=n.zip.file(/\.xml\.rels/).concat(n.zip.file(/\[Content_Types\].xml/)).map(function(e){return e.name});this.fileTypeConfig=n.fileTypeConfig;this.fileType=n.fileType;this.zip=n.zip;c.xmlFileNames=c.xmlFileNames.concat(t);return c}},
        {key:"set",value:function(c){c.zip&&(this.zip=c.zip);c.xmlDocuments&&(this.xmlDocuments=c.xmlDocuments)}},{key:"parse",value:function(c){return this.options.setParser?this.options.setParser(c):"%%"===c.substring(0,2)?{type:"placeholder",value:c.substr(2),module:"open-xml-templating/docxtemplater-image-module",centered:!0}:"%"===c.substring(0,1)?{type:"placeholder",value:c.substr(1),module:"open-xml-templating/docxtemplater-image-module",centered:!1}:null}},{key:"postparse",value:function(c){if("pptx"===
                this.fileType){var n="p:sp";var t=w}else n=this.options.centered?"w:p":"w:t",t=B;return E.traits.expandToOne(c,{moduleName:"open-xml-templating/docxtemplater-image-module",getInner:t,expandTo:n})}},{key:"render",value:function(c,n){if("open-xml-templating/docxtemplater-image-module"!==c.module)return null;var t=n.scopeManager.getValue(c.value,{part:c});if(!t)return{value:this.fileTypeConfig.tagTextXml};if("object"===("undefined"===typeof t?"undefined":C(t)))return this.getRenderedPart(c,t.rId,t.sizePixel);
                var e=new g(this.zip,n.filePath,this.xmlDocuments,this.fileType),q=this.options.getImage(t,c.value);e=e.addImageRels(this.getNextImageName(),q);t=this.options.getSize(q,t,c.value);return this.getRenderedPart(c,e,t)}},{key:"resolve",value:function(c,n){var t=this,e=new g(this.zip,n.filePath,this.xmlDocuments,this.fileType);if("open-xml-templating/docxtemplater-image-module"!==c.module)return null;var q=n.scopeManager.getValue(c.value,{part:c});return q?(new Promise(function(A){var l=t.options.getImage(q,
                c.value);A(l)})).then(function(A){var l=e.addImageRels(t.getNextImageName(),A);return(new Promise(function(h){var a=t.options.getSize(A,q,c.value);h(a)})).then(function(h){return{rId:l,sizePixel:h}})}):{value:this.fileTypeConfig.tagTextXml}}},{key:"getRenderedPart",value:function(c,n,t){if(n!==n)throw Error("rId is NaN, aborting");t=[E.convertPixelsToEmus(t[0]),E.convertPixelsToEmus(t[1])];var e=this.options.centered||c.centered;return{value:"pptx"===this.fileType?this.getRenderedPartPptx(c,n,t,e):
                    this.getRenderedPartDocx(n,t,e)}}},{key:"getRenderedPartPptx",value:function(c,n,t,e){var q={x:parseInt(c.offset.x,10),y:parseInt(c.offset.y,10)},A=parseInt(c.ext.cx,10)||1;c=parseInt(c.ext.cy,10)||1;var l=parseInt(t[0],10)||1;t=parseInt(t[1],10)||1;e&&(q.x=Math.round(q.x+A/2-l/2),q.y=Math.round(q.y+c/2-t/2));return z.getPptxImageXml(n,[l,t],q)}},{key:"getRenderedPartDocx",value:function(c,n,t){return t?z.getImageXmlCentered(c,n):z.getImageXml(c,n)}},{key:"getNextImageName",value:function(){var c=
                "image_generated_"+this.imageNumber+".png";this.imageNumber++;return c}}]);return m}();H.exports=p},{"./imgManager":2,"./templates":3,docxtemplater:5,xmldom:25}],1:[function(p,H,x){p=p("docxtemplater").DocUtils;p.convertPixelsToEmus=function(B){return Math.round(9525*B)};H.exports=p},{docxtemplater:5}],2:[function(p,H,x){var B=function(){function z(E,G){for(var g=0;g<G.length;g++){var m=G[g];m.enumerable=m.enumerable||!1;m.configurable=!0;"value"in m&&(m.writable=!0);Object.defineProperty(E,m.key,
        m)}}return function(E,G,g){G&&z(E.prototype,G);g&&z(E,g);return E}}(),w=p("./docUtils"),C=/[^.]+\.([^.]+)/,F={getPrefix:function(z){return"docx"===z?"word":"ppt"},getFileTypeName:function(z){return"docx"===z?"document":"presentation"},getRelsFileName:function(z){return z.replace(/^.*?([a-zA-Z0-9]+)\.xml$/,"$1")+".xml.rels"},getRelsFilePath:function(z,E){var G=F.getRelsFileName(z);return("pptx"===E?"ppt/slides":"word")+"/_rels/"+G}};H.exports=function(){function z(E,G,g,m){if(!(this instanceof z))throw new TypeError("Cannot call a class as a function");
        this.fileName=G;this.prefix=F.getPrefix(m);this.zip=E;this.xmlDocuments=g;this.fileTypeName=F.getFileTypeName(m);this.mediaPrefix="pptx"===m?"../media":"media";E=F.getRelsFilePath(G,m);this.relsDoc=g[E]||this.createEmptyRelsDoc(g,E)}B(z,[{key:"createEmptyRelsDoc",value:function(E,G){var g=this.prefix+"/_rels/"+this.fileTypeName+".xml.rels",m=E[g];if(!m)throw m=Error("Could not copy from empty relsdoc"),m.properties={mainRels:g,relsFileName:G,files:Object.keys(this.zip.files)},m;g=w.str2xml(w.xml2str(m));
            m=g.getElementsByTagName("Relationships")[0];for(var c=m.getElementsByTagName("Relationship"),n=0,t=c.length;n<t;n++)m.removeChild(c[n]);return E[G]=g}},{key:"loadImageRels",value:function(){var E=this.relsDoc.getElementsByTagName("Relationship");return Array.prototype.reduce.call(E,function(G,g){var m=g.getAttribute("Id");return/^rId[0-9]+$/.test(m)?Math.max(G,parseInt(m.substr(3),10)):G},0)}},{key:"addExtensionRels",value:function(E,G){var g=this.xmlDocuments["[Content_Types].xml"],m=g.getElementsByTagName("Default");
            Array.prototype.some.call(m,function(c){return c.getAttribute("Extension")===G})||(m=g.getElementsByTagName("Types")[0],g=g.createElement("Default"),g.setAttribute("ContentType",E),g.setAttribute("Extension",G),m.appendChild(g))}},{key:"addImageRels",value:function(E,G,g){null==g&&(g=0);var m=0===g?E:E+("("+g+")"),c=this.prefix+"/media/"+m;if(null!=this.zip.files[c])return this.addImageRels(E,G,g+1);this.zip.file(c,G,{binary:!0});E=m.replace(C,"$1");this.addExtensionRels("image/"+E,E);E=this.relsDoc.getElementsByTagName("Relationships")[0];
            G=this.relsDoc.createElement("Relationship");g=this.loadImageRels()+1;G.setAttribute("Id","rId"+g);G.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image");G.setAttribute("Target",this.mediaPrefix+"/"+m);E.appendChild(G);return g}}]);return z}()},{"./docUtils":1}],3:[function(p,H,x){H.exports={getImageXml:function(B,w){return('<w:drawing>\n\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t<wp:extent cx="'+w[0]+'" cy="'+w[1]+'"/>\n\t\t\t<wp:effectExtent l="0" t="0" r="0" b="0"/>\n\t\t\t<wp:docPr id="2" name="Image 2" descr="image"/>\n\t\t\t<wp:cNvGraphicFramePr>\n\t\t\t\t<a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/>\n\t\t\t</wp:cNvGraphicFramePr>\n\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture 1" descr="image"/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+
            B+'">\n\t\t\t\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t\t\t\t</a:extLst>\n\t\t\t\t\t\t\t</a:blip>\n\t\t\t\t\t\t\t<a:srcRect/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+
            w[0]+'" cy="'+w[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln>\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t</pic:pic>\n\t\t\t\t</a:graphicData>\n\t\t\t</a:graphic>\n\t\t</wp:inline>\n\t</w:drawing>\n\t\t').replace(/\t|\n/g,"")},getImageXmlCentered:function(B,w){return('<w:p>\n\t\t\t<w:pPr>\n\t\t\t\t<w:jc w:val="center"/>\n\t\t\t</w:pPr>\n\t\t\t<w:r>\n\t\t\t\t<w:rPr/>\n\t\t\t\t<w:drawing>\n\t\t\t\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t\t\t<wp:extent cx="'+
            w[0]+'" cy="'+w[1]+'"/>\n\t\t\t\t\t<wp:docPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+
            B+'"/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+w[0]+'" cy="'+w[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln w="9525">\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t\t</pic:pic>\n\t\t\t\t\t\t</a:graphicData>\n\t\t\t\t\t</a:graphic>\n\t\t\t\t\t</wp:inline>\n\t\t\t\t</w:drawing>\n\t\t\t</w:r>\n\t\t</w:p>\n\t\t').replace(/\t|\n/g,
            "")},getPptxImageXml:function(B,w,C){return('<p:pic>\n\t\t\t<p:nvPicPr>\n\t\t\t\t<p:cNvPr id="6" name="Picture 2"/>\n\t\t\t\t<p:cNvPicPr>\n\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t</p:cNvPicPr>\n\t\t\t\t<p:nvPr/>\n\t\t\t</p:nvPicPr>\n\t\t\t<p:blipFill>\n\t\t\t\t<a:blip r:embed="rId'+B+'" cstate="print">\n\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t</a:extLst>\n\t\t\t\t</a:blip>\n\t\t\t\t<a:srcRect/>\n\t\t\t\t<a:stretch>\n\t\t\t\t\t<a:fillRect/>\n\t\t\t\t</a:stretch>\n\t\t\t</p:blipFill>\n\t\t\t<p:spPr bwMode="auto">\n\t\t\t\t<a:xfrm>\n\t\t\t\t\t<a:off x="'+
            C.x+'" y="'+C.y+'"/>\n\t\t\t\t\t<a:ext cx="'+w[0]+'" cy="'+w[1]+'"/>\n\t\t\t\t</a:xfrm>\n\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t<a:avLst/>\n\t\t\t\t</a:prstGeom>\n\t\t\t\t<a:noFill/>\n\t\t\t\t<a:ln>\n\t\t\t\t\t<a:noFill/>\n\t\t\t\t</a:ln>\n\t\t\t\t<a:effectLst/>\n\t\t\t\t<a:extLst>\n\t\t\t\t\t<a:ext uri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}">\n\t\t\t\t\t\t<a14:hiddenFill xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="accent1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t</a14:hiddenFill>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{91240B29-F687-4F45-9708-019B960494DF}">\n\t\t\t\t\t\t<a14:hiddenLine xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" w="9525">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="tx1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t</a14:hiddenLine>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{AF507438-7753-43E0-B8FC-AC1667EBCBE1}">\n\t\t\t\t\t\t<a14:hiddenEffects xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:effectLst>\n\t\t\t\t\t\t\t\t<a:outerShdw dist="35921" dir="2700000" algn="ctr" rotWithShape="0">\n\t\t\t\t\t\t\t\t\t<a:schemeClr val="bg2"/>\n\t\t\t\t\t\t\t\t</a:outerShdw>\n\t\t\t\t\t\t\t</a:effectLst>\n\t\t\t\t\t\t</a14:hiddenEffects>\n\t\t\t\t\t</a:ext>\n\t\t\t\t</a:extLst>\n\t\t\t</p:spPr>\n\t\t</p:pic>\n\t\t').replace(/\t|\n/g,
            "")}}},{}],4:[function(p,H,x){function B(l,h,a){h in l?Object.defineProperty(l,h,{value:a,enumerable:!0,configurable:!0,writable:!0}):l[h]=a;return l}function w(l){return l[l.length-1]}function C(l){return l.replace(t,"\\$&")}function F(l,h,a){for(var d=l.length;a<d;a++)if(l[a].value==="</"+h+">")return a;return null}function z(l,h,a){for(;0<=a;a--){var d=l[a];if(0===d.value.indexOf("<"+h)&&-1!==[">"," "].indexOf(d.value[h.length+1]))return a}return null}function E(l,h){var a=h.tag,d=h.position;return"tag"===
        h.type&&a===l&&"start"===d}function G(l,h){var a=h.tag,d=h.position;return"tag"===h.type&&a===l&&"end"===d}x=p("xmldom");var g=x.DOMParser,m=x.XMLSerializer,c=p("./errors").throwXmlTagNotFound,n={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;",'"':"&quot;"},t=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,e=Object.keys(n).map(function(l){var h=n[l];return{rstart:new RegExp(C(h),"g"),rend:new RegExp(C(l),"g"),start:h,end:l}}),q=new RegExp(String.fromCharCode(160),"g"),A=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;H.exports=
        {endsWith:function(l,h){return-1!==l.indexOf(h,l.length-h.length)},startsWith:function(l,h){return l.substring(0,h.length)===h},getNearestLeft:function(l,h,a){for(;0<=a;a--)for(var d=l[a],k=0,u=h.length;k<u;k++){var v=h[k];if(0===d.value.indexOf("<"+v)&&-1!==[">"," "].indexOf(d.value[v.length+1]))return h[k]}return null},getNearestRight:function(l,h,a){for(var d=l.length;a<d;a++)for(var k=l[a],u=0,v=h.length;u<v;u++)if(k.value==="</"+h[u]+">")return h[u];return-1},isContent:function(l){return"placeholder"===
                l.type||"content"===l.type&&"insidetag"===l.position},isParagraphStart:function(l){return E("w:p",l)||E("a:p",l)},isParagraphEnd:function(l){return G("w:p",l)||G("a:p",l)},isTagStart:E,isTagEnd:G,isTextStart:function(l){return"tag"===l.type&&"start"===l.position&&l.text},isTextEnd:function(l){return"tag"===l.type&&"end"===l.position&&l.text},unique:function(l){for(var h={},a=[],d=0,k=l.length;d<k;++d)h.hasOwnProperty(l[d])||(h[l[d]]=!0,a.push(l[d]));return a},chunkBy:function(l,h){return l.reduce(function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               d){var k=w(a);if(0===k.length)return k.push(d),a;var u=h(d);"start"===u?a.push([d]):"end"===u?(k.push(d),a.push([])):k.push(d);return a},[[]]).filter(function(a){return 0<a.length})},last:w,mergeObjects:function(){for(var l={},h,a,d=0;d<arguments.length;d+=1){h=arguments[d];a=Object.keys(h);for(var k=0;k<a.length;k+=1)l[a[k]]=h[a[k]]}return l},xml2str:function(l){return(new m).serializeToString(l).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(l){return(new g).parseFromString(l,"text/xml")},
            getRightOrNull:F,getRight:function(l,h,a){var d=F(l,h,a);if(null!==d)return d;c({position:"right",element:h,parsed:l,index:a})},getLeftOrNull:z,getLeft:function(l,h,a){var d=z(l,h,a);if(null!==d)return d;c({position:"left",element:h,parsed:l,index:a})},pregMatchAll:function(l,h){for(var a=[],d;null!=(d=l.exec(h));)a.push({array:d,offset:d.index});return a},convertSpaces:function(l){return l.replace(q," ")},escapeRegExp:C,charMapRegexes:e,hasCorruptCharacters:function(l){return A.test(l)},defaults:{nullGetter:function(l){return l.module?
                    "":"undefined"},xmlFileNames:[],parser:function(l){return B({},"get",function(h){return"."===l?h:h[l]})},linebreaks:!1,delimiters:{start:"{",end:"}"}},wordToUtf8:function(l){for(var h,a=0,d=e.length;a<d;a++)h=e[a],l=l.replace(h.rstart,h.end);return l},utf8ToWord:function(l){"string"!==typeof l&&(l=l.toString());for(var h,a=0,d=e.length;a<d;a++)h=e[a],l=l.replace(h.rend,h.start);return l},concatArrays:function(l){for(var h=[],a=0;a<l.length;a++)for(var d=l[a],k=0,u=d.length;k<u;k++)h.push(d[k]);return h},
            charMap:n}},{"./errors":6,xmldom:25}],5:[function(p,H,x){function B(h,a){for(var d=0;d<a.length;d++){var k=a[d];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(h,k.key,k)}}function w(h,a,d){a&&B(h.prototype,a);d&&B(h,d);return h}x=p("./doc-utils");x.traits=p("./traits");x.moduleWrapper=p("./module-wrapper");var C=p("./lexer"),F=x.defaults,z=x.str2xml,E=x.xml2str,G=x.moduleWrapper,g=x.utf8ToWord,m=x.concatArrays,c=x.unique,n=p("./errors"),t=n.XTInternalError,
        e=n.throwFileTypeNotIdentified,q=n.throwFileTypeNotHandled,A=n.throwApiVersionError,l=[3,7,0];n=function(){function h(){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");if(0<arguments.length)throw Error("The constructor with parameters has been removed in docxtemplater 3, please check the upgrade guide.");this.compiled={};this.modules=[];this.setOptions({})}w(h,[{key:"getModuleApiVersion",value:function(){return l.join(".")}},{key:"verifyApiVersion",value:function(a){a=
            a.split(".").map(function(d){return parseInt(d,10)});3!==a.length&&A("neededVersion is not a valid version",{neededVersion:a,explanation:"the neededVersion must be an array of length 3"});a[0]!==l[0]&&A("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:a,currentModuleApiVersion:l,explanation:"moduleAPIVersionMismatch : needed=".concat(a.join("."),", current=").concat(l.join("."))});a[1]>l[1]&&A("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",
            {neededVersion:a,currentModuleApiVersion:l,explanation:"moduleAPIVersionMismatch : needed=".concat(a.join("."),", current=").concat(l.join("."))});return!0}},{key:"setModules",value:function(a){this.modules.forEach(function(d){d.set(a)})}},{key:"sendEvent",value:function(a){this.modules.forEach(function(d){d.on(a)})}},{key:"attachModule",value:function(a){var d=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prefix;d&&(a.prefix=d);d=G(a);this.modules.push(d);d.on("attached");return this}},
        {key:"setOptions",value:function(a){var d=this;a.delimiters&&(a.delimiters.start=g(a.delimiters.start),a.delimiters.end=g(a.delimiters.end));this.options=a;Object.keys(F).forEach(function(k){var u=F[k];d.options[k]=null!=d.options[k]?d.options[k]:u;d[k]=d.options[k]});this.zip&&this.updateFileTypeConfig();return this}},{key:"loadZip",value:function(a){if(a.loadAsync)throw new t("Docxtemplater doesn't handle JSZip version >=3, see changelog");this.zip=a;this.updateFileTypeConfig();this.modules=m([this.fileTypeConfig.baseModules.map(function(d){return d()}),
                this.modules]);return this}},{key:"compileFile",value:function(a){var d=this.createTemplateClass(a);d.parse();this.compiled[a]=d}},{key:"resolveData",value:function(a){var d=this;return Promise.all(Object.keys(this.compiled).map(function(k){return d.compiled[k].resolveTags(a)})).then(function(k){return m(k)})}},{key:"compile",value:function(){var a=this;if(Object.keys(this.compiled).length)return this;this.options=this.modules.reduce(function(d,k){return k.optionsTransformer(d,a)},this.options);this.options.xmlFileNames=
                c(this.options.xmlFileNames);this.xmlDocuments=this.options.xmlFileNames.reduce(function(d,k){var u=a.zip.files[k].asText();d[k]=z(u);return d},{});this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments});this.getTemplatedFiles();this.setModules({compiled:this.compiled});this.templatedFiles.forEach(function(d){null!=a.zip.files[d]&&a.compileFile(d)});return this}},{key:"updateFileTypeConfig",value:function(){var a;this.zip.files.mimetype&&(a="odt");if(this.zip.files["word/document.xml"]||this.zip.files["word/document2.xml"])a=
                "docx";this.zip.files["ppt/presentation.xml"]&&(a="pptx");"odt"===a&&q(a);a||e();this.fileType=a;this.fileTypeConfig=this.options.fileTypeConfig||h.FileTypeConfig[this.fileType];return this}},{key:"render",value:function(){var a=this;this.compile();this.setModules({data:this.data,Lexer:C});this.mapper=this.modules.reduce(function(d,k){return k.getRenderedMap(d)},{});this.fileTypeConfig.tagsXmlLexedArray=c(this.fileTypeConfig.tagsXmlLexedArray);this.fileTypeConfig.tagsXmlTextArray=c(this.fileTypeConfig.tagsXmlTextArray);
                Object.keys(this.mapper).forEach(function(d){var k=a.mapper[d],u=a.compiled[k.from];u.setTags(k.data);u.render(d);a.zip.file(d,u.content,{createFolders:!0})});this.sendEvent("syncing-zip");this.syncZip();return this}},{key:"syncZip",value:function(){var a=this;Object.keys(this.xmlDocuments).forEach(function(d){a.zip.remove(d);var k=E(a.xmlDocuments[d]);return a.zip.file(d,k,{createFolders:!0})})}},{key:"setData",value:function(a){this.data=a;return this}},{key:"getZip",value:function(){return this.zip}},
        {key:"createTemplateClass",value:function(a){var d=this.zip.files[a].asText();return this.createTemplateClassFromContent(d,a)}},{key:"createTemplateClassFromContent",value:function(a,d){var k=this,u={filePath:d};Object.keys(F).forEach(function(v){u[v]=k[v]});u.fileTypeConfig=this.fileTypeConfig;u.modules=this.modules;return new h.XmlTemplater(a,u)}},{key:"getFullText",value:function(a){return this.createTemplateClass(a||this.fileTypeConfig.textPath(this.zip)).getFullText()}},{key:"getTemplatedFiles",
            value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip)}}]);return h}();n.DocUtils=x;n.Errors=p("./errors");n.XmlTemplater=p("./xml-templater");n.FileTypeConfig=p("./file-type-config");n.XmlMatcher=p("./xml-matcher");H.exports=n},{"./doc-utils":4,"./errors":6,"./file-type-config":7,"./lexer":8,"./module-wrapper":10,"./traits":22,"./xml-matcher":23,"./xml-templater":24}],6:[function(p,H,x){function B(g){for(var m=1;m<arguments.length;m++){var c=null!=arguments[m]?
        arguments[m]:{},n=Object.keys(c);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(c).filter(function(t){return Object.getOwnPropertyDescriptor(c,t).enumerable})));n.forEach(function(t){var e=c[t];t in g?Object.defineProperty(g,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[t]=e})}return g}function w(g){this.name="GenericError";this.message=g;this.stack=Error(g).stack}function C(g){this.name="TemplateError";this.message=g;this.stack=Error(g).stack}
        function F(g){this.name="RenderingError";this.message=g;this.stack=Error(g).stack}function z(g){this.name="ScopeParserError";this.message=g;this.stack=Error(g).stack}function E(g){this.name="InternalError";this.properties={explanation:"InternalError"};this.message=g;this.stack=Error(g).stack}function G(g){this.name="APIVersionError";this.properties={explanation:"APIVersionError"};this.message=g;this.stack=Error(g).stack}w.prototype=Error.prototype;C.prototype=new w;F.prototype=new w;z.prototype=new w;
        E.prototype=new w;G.prototype=new w;H.exports={XTError:w,XTTemplateError:C,XTInternalError:E,XTScopeParserError:z,XTAPIVersionError:G,RenderingError:F,getClosingTagNotMatchOpeningTag:function(g){g=g.tags;var m=new C("Closing tag does not match opening tag");m.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(g[0].value,'" is closed by the tag "').concat(g[1].value,'"'),openingtag:g[0].value,offset:[g[0].offset,g[1].offset],closingtag:g[1].value};return m},getLoopPositionProducesInvalidXMLError:function(g){g=
                g.tag;var m=new C('The position of the loop tags "'.concat(g,'" would produce invalid XML'));m.properties={tag:g,id:"loop_position_invalid",explanation:'The tags "'.concat(g,'" are misplaced in the document, for example one of them is in a table and the other one outside the table')};return m},getScopeCompilationError:function(g){var m=g.tag;g=g.rootError;var c=new z("Scope parser compilation failed");c.properties={id:"scopeparser_compilation_failed",tag:m,explanation:'The scope parser for the tag "'.concat(m,
                    '" failed to compile'),rootError:g};return c},getScopeParserExecutionError:function(g){var m=g.tag,c=g.scope;g=g.error;var n=new z("Scope parser execution failed");n.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(m," failed to execute"),scope:c,tag:m,rootError:g};return n},getUnclosedTagException:function(g){var m=new C("Unclosed tag");m.properties={xtag:g.xtag.split(" ")[0].substr(1),id:"unclosed_tag",context:g.xtag,offset:g.offset,lIndex:g.lIndex,
                explanation:'The tag beginning with "'.concat(g.xtag.substr(0,10),'" is unclosed')};return m},getUnmatchedLoopException:function(g){var m=g.location,c="start"===m?"unclosed":"unopened";m=new C("".concat("start"===m?"Unclosed":"Unopened"," loop"));g=g.part.value;m.properties={id:"".concat(c,"_loop"),explanation:'The loop with tag "'.concat(g,'" is ').concat(c),xtag:g};return m},getUnopenedTagException:function(g){var m=new C("Unopened tag"),c=g.xtag.split(" ");m.properties={xtag:c[c.length-1],id:"unopened_tag",
                context:g.xtag,offset:g.offset,lIndex:g.lIndex,explanation:'The tag beginning with "'.concat(g.xtag.substr(0,10),'" is unopened')};return m},throwApiVersionError:function(g,m){var c=new G(g);c.properties=B({id:"api_version_error"},m);throw c;},throwContentMustBeString:function(g){var m=new E("Content must be a string");m.properties.id="xmltemplater_content_must_be_string";m.properties.type=g;throw m;},throwCorruptCharacters:function(g){var m=g.tag;g=g.value;var c=new F("There are some XML corrupt characters");
                c.properties={id:"invalid_xml_characters",xtag:m,value:g,explanation:"There are some corrupt characters for the field ${tag}"};throw c;},throwFileTypeNotHandled:function(g){var m=new E('The filetype "'.concat(g,'" is not handled by docxtemplater'));m.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(g,'", but only docx and pptx formats are handled'),fileType:g};throw m;},throwFileTypeNotIdentified:function(){var g=new E("The filetype for this file could not be identified, is this file corrupted ?");
                g.properties={id:"filetype_not_identified"};throw g;},throwLocationInvalid:function(g){throw new E('Location should be one of "start" or "end" (given : '.concat(g.location,")"));},throwMalformedXml:function(g){var m=new E("Malformed xml");m.properties={part:g,id:"malformed_xml"};throw m;},throwMultiError:function(g){var m=new C("Multi error");m.properties={errors:g,id:"multi_error",explanation:"The template has multiple errors"};throw m;},throwRawTagNotInParagraph:function(g){var m=new C("Raw tag not in paragraph"),
                c=g.part,n=c.value;c=c.offset;m.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'.concat(n,'" is not inside a paragraph'),rootError:g.rootError,xtag:n,offset:c,postparsed:g.postparsed,expandTo:g.expandTo,index:g.index};throw m;},throwRawTagShouldBeOnlyTextInParagraph:function(g){var m=new C("Raw tag should be the only text in paragraph"),c=g.part.value;m.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(c,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),
                xtag:c,offset:g.part.offset,paragraphParts:g.paragraphParts};throw m;},throwUnimplementedTagType:function(g){var m=new C('Unimplemented tag type "'.concat(g.type,'"'));m.properties={part:g,id:"unimplemented_tag_type"};throw m;},throwXmlTagNotFound:function(g){var m=new C('No tag "'.concat(g.element,'" was found at the ').concat(g.position));m.properties={id:"no_xml_tag_found_at_".concat(g.position),explanation:'No tag "'.concat(g.element,'" was found at the ').concat(g.position),part:g.parsed[g.index],
                parsed:g.parsed,index:g.index,element:g.element};throw m;},throwXmlInvalid:function(g,m){var c=new C("An XML file has invalid xml");c.properties={id:"file_has_invalid_xml",content:g,offset:m,explanation:"The docx contains invalid XML, it is most likely corrupt"};throw c;}}},{}],7:[function(p,H,x){x=p("./modules/loop");var B=p("./modules/space-preserve"),w=p("./modules/rawxml"),C=p("./modules/expand-pair-trait");p=p("./modules/render");H.exports={docx:{getTemplatedFiles:function(F){return F.file(/word\/(header|footer)\d+\.xml/).map(function(z){return z.name}).concat(["docProps/core.xml",
                "docProps/app.xml","word/document.xml","word/document2.xml"])},textPath:function(F){if(F.files["word/document.xml"])return"word/document.xml";if(F.files["word/document2.xml"])return"word/document2.xml"},tagsXmlTextArray:"Company HyperlinkBase Manager cp:category cp:keywords dc:creator dc:description dc:subject dc:title w:t m:t vt:lpstr".split(" "),tagsXmlLexedArray:"w:tc w:tr w:table w:p w:r w:rPr w:pPr w:spacing".split(" "),expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",
                expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[x,B,C,w,p]},pptx:{getTemplatedFiles:function(F){return F.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(z){return z.name}).concat(["ppt/presentation.xml","docProps/app.xml","docProps/core.xml"])},textPath:function(){return"ppt/slides/slide1.xml"},tagsXmlTextArray:"Company HyperlinkBase Manager cp:category cp:keywords dc:creator dc:description dc:subject dc:title a:t m:t vt:lpstr".split(" "),
            tagsXmlLexedArray:"p:sp a:tc a:tr a:table a:p a:r a:rPr".split(" "),expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[x,C,w,p]}}},{"./modules/expand-pair-trait":11,"./modules/loop":12,"./modules/rawxml":13,"./modules/render":14,"./modules/space-preserve":15}],8:[function(p,H,x){function B(h,a){var d=Array.isArray(h)?h:void 0;if(!d){d=[];var k=!0,u=!1,v=void 0;try{var y=h[Symbol.iterator]();for(var I;!(k=
        (I=y.next()).done)&&(d.push(I.value),!a||d.length!==a);k=!0);}catch(J){u=!0,v=J}finally{try{if(!k&&null!=y["return"])y["return"]()}finally{if(u)throw v;}}}if(!(y=d))throw new TypeError("Invalid attempt to destructure non-iterable instance");return y}function w(h,a){return h[0]<=a.offset&&a.offset<h[1]}function C(h,a){return A(h)?(a&&t(h),!0):l(h)?(a||t(h),!1):a}function F(h){var a="start",d=1;"/"===h[h.length-2]&&(a="selfclosing");"/"===h[1]&&(d=2,a="end");var k=h.indexOf(" ");return{tag:h.slice(d,
            -1===k?h.length-1:k),position:a}}function z(h,a,d){var k=0,u=h.length;a=q([a.map(function(K){return{tag:K,text:!0}}),d.map(function(K){return{tag:K,text:!1}})]).reduce(function(K,S){K[S.tag]=S.text;return K},{});for(d=[];k<u;){k=h.indexOf("<",k);if(-1===k)break;var v=k,y=h.indexOf("<",k+1);k=h.indexOf(">",k);(-1===k||-1!==y&&k>y)&&e(h,v);y=h.slice(v,k+1);var I=F(y),J=I.tag,M=a[J];null!=M&&d.push({type:"tag",position:I.position,text:M,offset:v,value:y,tag:J})}return d}function E(h,a,d){if(0===h.length)return[];
        var k=[],u=!1,v={offset:0},y=0;h.forEach(function(J){for(;d[y+1]&&!(d[y+1].offset>J.offset);)y++;I=a.substr(v.offset,J.offset-v.offset);"start"===J.position&&u||"end"===J.position&&!u?("start"===J.position?k.push(c({xtag:I,offset:v.offset})):k.push(n({xtag:I,offset:J.offset})),J.error=!0):u=!u;v=J});var I=a.substr(v.offset,a.length-v.offset);u&&k.push(c({xtag:I,offset:v.offset}));return k}function G(h,a){for(var d=[],k=a.start,u=a.end,v=-1;;){var y=h.indexOf(k,v+1),I=h.indexOf(u,v+1),J=null,M=void 0;
        var K=y===I?0:-1===y||-1===I?I<y?-1:1:y<I?-1:1;if(0===K)return d;1===K&&(v=I,J="end",M=u.length);-1===K&&(v=y,J="start",M=k.length);if("start"===J&&"="===h[v+k.length]){d.push({offset:y,position:"start",length:k.length,changedelimiter:!0});I=h.indexOf("=",v+k.length+1);y=h.indexOf(u,I+1);d.push({offset:y,position:"end",length:u.length,changedelimiter:!0});k=h.substr(v+k.length+1,I-v-k.length-1).split(" ");if(2!==k.length)throw Error("New Delimiters cannot be parsed");u=B(k,2);k=u[0];u=u[1];if(0===
            k.length||0===u.length)throw Error("New Delimiters cannot be parsed");u=B([k,u],2);k=u[0];u=u[1];v=y}else d.push({offset:v,position:J,length:M})}}function g(h){var a=this;this.innerContentParts=h;this.full="";this.parseDelimiters=function(d){a.full=a.innerContentParts.map(function(J){return J.value}).join("");var k=G(a.full,d),u=0;d=a.innerContentParts.map(function(J){u+=J.value.length;return{offset:u-J.value.length,lIndex:J.lIndex}});var v=E(k,a.full,d),y=0,I=0;a.parsed=d.map(function(J,M){for(var K=
        J.offset,S=[K,K+this.innerContentParts[M].value.length],Q=this.innerContentParts[M].value,N=[];I<k.length&&w(S,k[I]);)N.push(k[I]),I++;var P=[],O=0;0<y&&(O=y,y=0);var ba;N.forEach(function(T){var Z=Q.substr(O,T.offset-K-O);if(0<Z.length){if(ba){T.changedelimiter&&(O=T.offset-K+T.length,ba="start"===T.position);return}P.push({type:"content",value:Z,offset:O+K});O+=Z.length}Z={type:"delimiter",position:T.position,offset:O+K};T.error&&(Z.error=T.error);T.changedelimiter?ba="start"===T.position:P.push(Z);
        O=T.offset-K+T.length});y=O-Q.length;S=Q.substr(O);0<S.length&&P.push({type:"content",value:S,offset:K});return P},a);a.errors=v}}function m(h){var a=!1,d=[];h.forEach(function(k){(a=C(k,a))&&"content"===k.type&&d.push(k)});return d}x=p("./errors");var c=x.getUnclosedTagException,n=x.getUnopenedTagException,t=x.throwMalformedXml,e=x.throwXmlInvalid;p=p("./doc-utils");var q=p.concatArrays,A=p.isTextStart,l=p.isTextEnd;H.exports={parse:function(h,a){var d=!1,k=new g(m(h));k.parseDelimiters(a);var u=
            [],v=0;h.forEach(function(y){d=C(y,d);"content"===y.type&&(y.position=d?"insidetag":"outsidetag");d&&"content"===y.type?(Array.prototype.push.apply(u,k.parsed[v].map(function(I){"content"===I.type&&(I.position="insidetag");return I})),v++):u.push(y)});u=u.map(function(y,I){y.lIndex=I;return y});return{errors:k.errors,lexed:u}},xmlparse:function(h,a){var d=0,k=z(h,a.text,a.other).reduce(function(v,y){var I=h.substr(d,y.offset-d);0<I.length&&v.push({type:"content",value:I});d=y.offset+y.value.length;
            delete y.offset;0<y.value.length&&v.push(y);return v},[]),u=h.substr(d);0<u.length&&k.push({type:"content",value:u});return k}}},{"./doc-utils":4,"./errors":6}],9:[function(p,H,x){function B(w,C){for(var F=-1,z=0,E=w.length;z<E;z++)C[z]>=w[z].length||!(-1===F||w[z][C[z]].offset<w[F][C[F]].offset)||(F=z);if(-1===F)throw Error("minIndex negative");return F}H.exports=function(w){var C=w.reduce(function(g,m){return g+m.length},0);w=w.filter(function(g){return 0<g.length});for(var F=Array(C),z=w.map(function(){return 0}),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             E=0;E<=C-1;){var G=B(w,z);F[E]=w[G][z[G]];z[G]++;E++}return F}},{}],10:[function(p,H,x){function B(){}function w(C){return C}H.exports=function(C){var F={set:B,parse:B,render:B,getTraits:B,nullGetter:B,optionsTransformer:w,postrender:w,errorsTransformer:w,getRenderedMap:w,postparse:w,on:B,resolve:B};if(Object.keys(F).every(function(z){return!C[z]}))throw Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");Object.keys(F).forEach(function(z){C[z]=C[z]||F[z]});
        return C}},{}],11:[function(p,H,x){function B(e){var q=[],A=[];if(0===e.length)return{pairs:A,errors:q};var l=1;var h=Array.isArray(e)?e:void 0;if(!h){h=[];var a=!0,d=!1,k=void 0;try{var u=e[Symbol.iterator]();for(var v;!(a=(v=u.next()).done)&&(h.push(v.value),1!==h.length);a=!0);}catch(y){d=!0,k=y}finally{try{if(!a&&null!=u["return"])u["return"]()}finally{if(d)throw k;}}}if(!(u=h))throw new TypeError("Invalid attempt to destructure non-iterable instance");u=u[0];if("start"===u.part.location)for(h=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1;h<e.length;h++){v=e[h];a:{a=v.part;switch(a.location){case "start":a=1;break a;case "end":a=-1;break a;default:n(a)}a=void 0}l+=a;if(0===l)return e=B(e.slice(h+1)),v.part.value!==u.part.value&&""!==v.part.value?q.push(c({tags:[u.part,v.part]})):A=[[u,v]],{pairs:A.concat(e.pairs),errors:q.concat(e.errors)}}A=u.part;q.push(m({part:A,location:A.location}));e=B(e.slice(1));return{pairs:e.pairs,errors:q.concat(e.errors)}}var w=p("../mergesort");x=p("../doc-utils");var C=x.getLeft,F=x.getRight,z=x.getNearestLeft,
        E=x.getNearestRight,G=p("../module-wrapper"),g=p("../traits").getExpandToDefault;p=p("../errors");var m=p.getUnmatchedLoopException,c=p.getClosingTagNotMatchOpeningTag,n=p.throwLocationInvalid,t={name:"ExpandPairTrait",optionsTransformer:function(e,q){this.expandTags=q.fileTypeConfig.expandTags.concat(q.options.paragraphLoop?q.fileTypeConfig.onParagraphLoop:[]);return e},postparse:function(e,q){var A=this,l=q.getTraits,h=q.postparse;l=l("expandPair",e);l=l.map(function(y){return y||[]});l=w(l);l=
            B(l);var a=l.pairs,d=l.errors,k=a.map(function(y){var I=y[0].part.expandTo;if("auto"===I){var J=g(e,y,A.expandTags);J.error&&d.push(J.error);I=J.value}if(!I)return[y[0].offset,y[1].offset];J=C(e,I,y[0].offset);y=F(e,I,y[1].offset);return[J,y]}),u=0,v;return{postparsed:e.reduce(function(y,I,J){var M=a[u],K=k[u];if(!(u<a.length&&k[u][0]<=J))return y.push(I),y;var S=K[1],Q=z(e,["w:p","w:tc"],K[0]-1);S=E(e,["w:p","w:tc"],S+1);"w:tc"===Q&&"w:tc"===S&&(I.emptyValue="<w:p></w:p>");K[0]===J&&(v=[]);M[0].offset!==
            J&&M[1].offset!==J&&v.push(I);K[1]===J&&(I=e[M[0].offset],I.subparsed=h(v,{basePart:I}),delete I.location,delete I.expandTo,y.push(I),u++);return y},[]),errors:d}}};H.exports=function(){return G(t)}},{"../doc-utils":4,"../errors":6,"../mergesort":9,"../module-wrapper":10,"../traits":22}],12:[function(p,H,x){function B(h,a){for(var d=0;d<a.length;d++){var k=a[d];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(h,k.key,k)}}function w(h,a,d){a&&B(h.prototype,
        a);d&&B(h,d);return h}function C(h){return h.some(function(a){return n(a)})}function F(h){return 0===h.length?!1:m(h[0])&&c(g(h))}function z(h){return C(h)?0:h.length}x=p("../doc-utils");var E=x.mergeObjects,G=x.chunkBy,g=x.last,m=x.isParagraphStart,c=x.isParagraphEnd,n=x.isContent,t=p("../module-wrapper");p=p("../prefix-matcher");var e=p.match,q=p.getValue,A=p.getValues,l=function(){function h(){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");this.name="LoopModule";
        this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)$/,inverted:"^"}}w(h,[{key:"parse",value:function(a){var d=this.prefix,k=d.start,u=d.inverted,v=d.dash;d=d.end;if(e(k,a))return{type:"placeholder",value:q(k,a),expandTo:"auto",module:"loop",location:"start",inverted:!1};if(e(u,a))return{type:"placeholder",value:q(u,a),expandTo:"auto",module:"loop",location:"start",inverted:!0};if(e(d,a))return{type:"placeholder",value:q(d,a),module:"loop",location:"end"};if(e(v,a)){a=A(v,a);k=Array.isArray(a)?a:
            void 0;if(!k){k=[];u=!0;v=!1;d=void 0;try{var y=a[Symbol.iterator]();for(var I;!(u=(I=y.next()).done)&&(k.push(I.value),3!==k.length);u=!0);}catch(J){v=!0,d=J}finally{try{if(!u&&null!=y["return"])y["return"]()}finally{if(v)throw d;}}}if(!(y=k))throw new TypeError("Invalid attempt to destructure non-iterable instance");return{type:"placeholder",value:y[2],expandTo:y[1],module:"loop",location:"start",inverted:!1}}return null}},{key:"getTraits",value:function(a,d){if("expandPair"===a)return d.reduce(function(k,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           u,v){"placeholder"===u.type&&"loop"===u.module&&k.push({part:u,offset:v});return k},[])}},{key:"postparse",value:function(a,d){var k=d.basePart;if(!F(a)||!k||"auto"!==k.expandTo||"loop"!==k.module)return a;var u=G(a,function(v){return m(v)?"start":c(v)?"end":null});if(2>=u.length)return a;k=u[0];u=g(u);k=z(k);u=z(u);return 0===k||0===u?a:a.slice(k,a.length-u)}},{key:"render",value:function(a,d){if("placeholder"!==a.type||"loop"!==a.module)return null;var k=[],u=[];return!1===d.scopeManager.loopOver(a.value,
            function(v,y){var I=d.scopeManager.createSubScopeManager(v,a.value,y,a);I=d.render(E({},d,{compiled:a.subparsed,tags:{},scopeManager:I}));k=k.concat(I.parts);u=u.concat(I.errors||[])},a.inverted,{part:a})?{value:a.emptyValue||"",errors:u}:{value:k.join(""),errors:u}}},{key:"resolve",value:function(a,d){function k(y,I){var J=d.scopeManager.createSubScopeManager(y,a.value,I,a);v.push(d.resolve(E(d,{compiled:a.subparsed,tags:{},scopeManager:J})))}if("placeholder"!==a.type||"loop"!==a.module)return null;
            var u=d.scopeManager.getValue(a.value,{part:a}),v=[];return Promise.resolve(u).then(function(y){d.scopeManager.loopOverValue(y,k,a.inverted);return Promise.all(v).then(function(I){return I.map(function(J){return J.resolved})})}).then(function(y){return y})}}]);return h}();H.exports=function(){return t(new l)}},{"../doc-utils":4,"../module-wrapper":10,"../prefix-matcher":18}],13:[function(p,H,x){function B(e,q){for(var A=0;A<q.length;A++){var l=q[A];l.enumerable=l.enumerable||!1;l.configurable=!0;
        "value"in l&&(l.writable=!0);Object.defineProperty(e,l.key,l)}}function w(e,q,A){q&&B(e.prototype,q);A&&B(e,A);return e}function C(e){var q=e.part,A=e.left,l=e.right,h=e.postparsed,a=e.index;e=E(h,["w:p","w:tc"],A-1);"w:tc"===G(h,["w:p","w:tc"],l+1)&&"w:tc"===e&&(q.emptyValue="<w:p></w:p>");var d=h.slice(A+1,l);d.forEach(function(k,u){u!==a-A-1&&z(k)&&g({paragraphParts:d,part:q})});return q}var F=p("../traits");x=p("../doc-utils");var z=x.isContent,E=x.getNearestLeft,G=x.getNearestRight,g=p("../errors").throwRawTagShouldBeOnlyTextInParagraph;
        x=p("../prefix-matcher");var m=x.match,c=x.getValue,n=p("../module-wrapper"),t=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="RawXmlModule";this.prefix="@"}w(e,[{key:"optionsTransformer",value:function(q,A){this.fileTypeConfig=A.fileTypeConfig;return q}},{key:"parse",value:function(q){return m(this.prefix,q)?{type:"placeholder",value:c(this.prefix,q),module:"rawxml"}:null}},{key:"postparse",value:function(q){return F.expandToOne(q,
                {moduleName:"rawxml",getInner:C,expandTo:this.fileTypeConfig.tagRawXml})}},{key:"render",value:function(q,A){if("rawxml"!==q.module)return null;var l=A.scopeManager.getValue(q.value,{part:q});null==l&&(l=A.nullGetter(q));return l?{value:l}:{value:q.emptyValue||""}}},{key:"resolve",value:function(q,A){return"placeholder"!==q.type||"rawxml"!==q.module?null:A.scopeManager.getValueAsync(q.value,{part:q}).then(function(l){return null==l?A.nullGetter(q):l})}}]);return e}();H.exports=function(){return n(new t)}},
        {"../doc-utils":4,"../errors":6,"../module-wrapper":10,"../prefix-matcher":18,"../traits":22}],14:[function(p,H,x){function B(c,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(c,e.key,e)}}function w(c,n,t){n&&B(c.prototype,n);t&&B(c,t);return c}var C=p("../module-wrapper"),F=p("../errors").getScopeCompilationError;x=p("../doc-utils");var z=x.utf8ToWord,E=x.hasCorruptCharacters,G=p("../errors").throwCorruptCharacters,
        g={docx:"w",pptx:"a"},m=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.name="Render";this.recordRun=!1;this.recordedRun=[]}w(c,[{key:"set",value:function(n){n.compiled&&(this.compiled=n.compiled);null!=n.data&&(this.data=n.data)}},{key:"getRenderedMap",value:function(n){var t=this;return Object.keys(this.compiled).reduce(function(e,q){e[q]={from:q,data:t.data};return e},n)}},{key:"optionsTransformer",value:function(n,t){this.parser=t.parser;
                this.fileType=t.fileType;return n}},{key:"postparse",value:function(n){var t=this,e=[];n.forEach(function(q){if("placeholder"===q.type){var A=q.value;try{t.parser(A,{tag:q})}catch(l){e.push(F({tag:A,rootError:l}))}}});return{postparsed:n,errors:e}}},{key:"recordRuns",value:function(n){n.tag==="".concat(g[this.fileType],":r")?(this.recordRun=!1,this.recordedRun=[]):n.tag==="".concat(g[this.fileType],":rPr")?("start"===n.position&&(this.recordRun=!0,this.recordedRun=[n.value]),"end"===n.position&&(this.recordedRun.push(n.value),
                this.recordRun=!1)):this.recordRun&&this.recordedRun.push(n.value)}},{key:"render",value:function(n,t){var e=t.scopeManager,q=t.linebreaks,A=t.nullGetter;q&&this.recordRuns(n);if("placeholder"===n.type&&!n.module){e=e.getValue(n.value,{part:n});null==e&&(e=A(n));E(e)&&G({tag:n.value,value:e});"string"!==typeof e&&(e=e.toString());if(q){q=g[this.fileType];A="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>";e=e.split("\n");var l=this.recordedRun.join("");return{value:e.map(function(h){return z(h)}).join("</".concat(q,
                    ":t></").concat(q,":r>").concat(A,"<").concat(q,":r>").concat(l,"<").concat(q,":t").concat("docx"===this.fileType?' xml:space="preserve"':"",">"))}}return{value:z(e)}}}}]);return c}();H.exports=function(){return C(new m)}},{"../doc-utils":4,"../errors":6,"../module-wrapper":10}],15:[function(p,H,x){function B(g,m){var c=g[m].value;return"</w:t>"===g[m+1].value||-1!==c.indexOf('xml:space="preserve"')?c:c.substr(0,c.length-1)+' xml:space="preserve">'}var w=p("../module-wrapper");p=p("../doc-utils");
        var C=p.isTextStart,F=p.isTextEnd,z=p.endsWith,E=p.startsWith,G={name:"SpacePreserveModule",postparse:function(g,m){var c=[],n=!1,t=0,e=0,q=g.reduce(function(A,l){C(l)&&"w:t"===l.tag&&(n=!0,e=c.length);if(!n)return A.push(l),A;c.push(l);m&&m.basePart&&1<c.length&&(t=m.basePart.endLindex,c[0].value=B(c,0));!(t||"placeholder"!==l.type||l.module&&"loop"!==l.module)&&1<c.length&&(t=l.endLindex,c[0].value=B(c,0));F(l)&&l.lIndex>t&&(0!==t&&(c[e].value=B(c,e)),Array.prototype.push.apply(A,c),c=[],n=!1,e=
                t=0);return A},[]);Array.prototype.push.apply(q,c);return q},postrender:function(g){return g.filter(function(m){return 0!==m.length}).reduce(function(m,c,n,t){-1!==c.indexOf('<w:t xml:space="preserve"></w:t>')&&(c=c.replace(/<w:t xml:space="preserve"><\/w:t>/g,"<w:t/>"));z(c,'<w:t xml:space="preserve">')&&E(t[n+1],"</w:t>")&&(c=c.substr(0,c.length-26)+"<w:t/>",t[n+1]=t[n+1].substr(6));m.push(c);return m},[])}};H.exports=function(){return w(G)}},{"../doc-utils":4,"../module-wrapper":10}],16:[function(p,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         H,x){function B(F){for(var z=1;z<arguments.length;z++){var E=null!=arguments[z]?arguments[z]:{},G=Object.keys(E);"function"===typeof Object.getOwnPropertySymbols&&(G=G.concat(Object.getOwnPropertySymbols(E).filter(function(g){return Object.getOwnPropertyDescriptor(E,g).enumerable})));G.forEach(function(g){var m=E[g];g in F?Object.defineProperty(F,g,{value:m,enumerable:!0,configurable:!0,writable:!0}):F[g]=m})}return F}p=p("./doc-utils");var w=p.wordToUtf8,C=p.concatArrays;H.exports={postparse:function(F,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    z){function E(m,c){return z.map(function(n){return n.getTraits(m,c)})}function G(m,c){return z.reduce(function(n,t){var e=t.postparse(n,B({},c,{postparse:G,getTraits:E}));return e.errors?(g=C([g,e.errors]),e.postparsed):e},m)}var g=[];return{postparsed:G(F),errors:g}},parse:function(F,z){var E=!1,G="",g,m=[];return F.reduce(function(c,n){if("delimiter"===n.type){E="start"===n.position;if("end"===n.position){var t=n.lIndex;G=w(G);a:{for(var e=G,q=c,A=g,l,h=0,a=z.length;h<a;h++)if(l=z[h].parse(e)){l.offset=
            A;l.endLindex=t;l.lIndex=t;l.raw=e;q.push(l);c=q;break a}q.push({type:"placeholder",value:e,offset:A,endLindex:t,lIndex:t});c=q}g=null;Array.prototype.push.apply(c,m);m=[]}"start"===n.position&&(m=[],g=n.offset);G="";return c}if(!E)return c.push(n),c;if("content"!==n.type||"insidetag"!==n.position)return m.push(n),c;G+=n.value;return c},[])}}},{"./doc-utils":4}],17:[function(p,H,x){H.exports=function(B,w){for(var C=0,F=w.modules.length;C<F;C++)B=w.modules[C].postrender(B,w);return B.join("")}},{}],
    18:[function(p,H,x){H.exports={match:function(B,w){if("string"===typeof B)return w.substr(0,B.length)===B;if(B instanceof RegExp)return B.test(w)},getValue:function(B,w){if("string"===typeof B)return w.substr(B.length);if(B instanceof RegExp)return w.match(B)[1]},getValues:function(B,w){if(B instanceof RegExp)return w.match(B)}}},{}],19:[function(p,H,x){var B=p("./doc-utils").concatArrays,w=p("./errors").throwUnimplementedTagType;H.exports=function(C){var F=C.baseNullGetter,z=C.compiled,E=C.scopeManager;
        C.nullGetter=function(g,m){return F(g,m||E)};var G=[];z=z.map(function(g){var m;a:{for(var c=0,n=C.modules.length;c<n;c++)if(m=C.modules[c].render(g,C))break a;m=!1}if(m)return m.errors&&(G=B([G,m.errors])),m.value;if("content"===g.type||"tag"===g.type)return g.value;w(g)});return{errors:G,parts:z}}},{"./doc-utils":4,"./errors":6}],20:[function(p,H,x){function B(w,C){for(var F,z=0,E=C.modules.length;z<E;z++)if(F=C.modules[z].resolve(w,C))return F;return!1}H.exports=function(w){var C=[],F=w.baseNullGetter,
        z=w.compiled,E=w.scopeManager;w.nullGetter=function(g,m){return F(g,m||E)};w.resolved=C;var G=[];return Promise.all(z.map(function(g){var m=B(g,w);if(m)return m.then(function(c){C.push({tag:g.value,value:c,lIndex:g.lIndex})});if("placeholder"===g.type)return E.getValueAsync(g.value,{part:g}).then(function(c){null==c&&(c=w.nullGetter(g));C.push({tag:g.value,value:c,lIndex:g.lIndex});return c})}).filter(function(g){return g})).then(function(){return{errors:G,resolved:C}})}},{}],21:[function(p,H,x){function B(g,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m){for(var c=0;c<m.length;c++){var n=m[c];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(g,n.key,n)}}function w(g,m,c){m&&B(g.prototype,m);c&&B(g,c);return g}function C(g,m){for(var c=g.length>>>0,n,t=0;t<c;t++)if(n=g[t],m.call(this,n,t,g))return n}function F(g,m,c){var n=this;this.num=c;var t=this.scopeList[this.num];if(this.resolved){var e=this.resolved;this.scopePath.forEach(function(l,h){var a=n.scopeLindex[h];e=C(e,function(d){return d.lIndex===
        a});e=e.value[n.scopePathItem[h]]});return C(e,function(l){return m.part.lIndex===l.lIndex}).value}var q=this.parser(g,{scopePath:this.scopePath});try{var A=q.get(t,this.getContext(m))}catch(l){throw E({tag:g,scope:t,error:l});}return null==A&&0<this.num?F.call(this,g,m,c-1):A}function z(g,m,c){var n=this;this.num=c;var t=this.scopeList[this.num],e=this.parser(g,{scopePath:this.scopePath});return Promise.resolve(e.get(t,this.getContext(m)))["catch"](function(q){throw E({tag:g,scope:t,error:q});}).then(function(q){return null==
    q&&0<c?z.call(n,g,m,c-1):q})}var E=p("./errors").getScopeParserExecutionError,G=function(){function g(m){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");this.scopePath=m.scopePath;this.scopePathItem=m.scopePathItem;this.scopeList=m.scopeList;this.scopeLindex=m.scopeLindex;this.parser=m.parser;this.resolved=m.resolved}w(g,[{key:"loopOver",value:function(m,c,n,t){n=n||!1;return this.loopOverValue(this.getValue(m,t),c,n)}},{key:"functorIfInverted",value:function(m,c,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     n,t){m&&c(n,t);return m}},{key:"isValueFalsy",value:function(m,c){return null==m||!m||"[object Array]"===c&&0===m.length}},{key:"loopOverValue",value:function(m,c,n){this.resolved&&(n=!1);var t=Object.prototype.toString.call(m),e=this.scopeList[this.num];if(this.isValueFalsy(m,t))return this.functorIfInverted(n,c,e,0);if("[object Array]"===t){for(t=0;t<m.length;t++)e=m[t],this.functorIfInverted(!n,c,e,t);return!0}return"[object Object]"===t?this.functorIfInverted(!n,c,m,0):this.functorIfInverted(!n,
            c,e,0)}},{key:"getValue",value:function(m,c){return F.call(this,m,c,this.scopeList.length-1)}},{key:"getValueAsync",value:function(m,c){return z.call(this,m,c,this.scopeList.length-1)}},{key:"getContext",value:function(m){return{num:this.num,meta:m,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem}}},{key:"createSubScopeManager",value:function(m,c,n,t){return new g({resolved:this.resolved,parser:this.parser,scopeList:this.scopeList.concat(m),
            scopePath:this.scopePath.concat(c),scopePathItem:this.scopePathItem.concat(n),scopeLindex:this.scopeLindex.concat(t.lIndex)})}}]);return g}();H.exports=function(g){g.scopePath=[];g.scopePathItem=[];g.scopeLindex=[];g.scopeList=[g.tags];return new G(g)}},{"./errors":6}],22:[function(p,H,x){function B(d){B="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(k){return typeof k}:function(k){return k&&"function"===typeof Symbol&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":
        typeof k};return B(d)}function w(d,k){if(0===d.length)return!1;var u=d[d.length-1].tag.substr(1),v=k.substr(2,k.length-3);return 0===u.indexOf(v)}function C(d,k){d.push({tag:k});return d}function F(d){d=d.filter(function(y){return"tag"===y.type});for(var k=[],u=0,v;u<d.length;u++)v=d[u].value,"/"===v[1]?w(k,v)?k.pop():k=C(k,v):"/"!==v[v.length-2]&&(k=C(k,v));return k}function z(d,k){for(var u=0;u<k.length;u++)if(0===k[u].tag.indexOf("<".concat(d)))return!0;return!1}x=p("./doc-utils");var E=x.getRightOrNull,
        G=x.getRight,g=x.getLeft,m=x.getLeftOrNull,c=x.concatArrays,n=x.chunkBy,t=x.isTagStart,e=x.isTagEnd,q=x.isContent,A=x.last;p=p("./errors");var l=p.XTTemplateError,h=p.throwRawTagNotInParagraph,a=p.getLoopPositionProducesInvalidXMLError;H.exports={expandToOne:function(d,k){var u=[];d.errors&&(u=d.errors,d=d.postparsed);d.reduce(function(v,y){"placeholder"===y.type&&y.module===k.moduleName&&v.push(y);return v},[]).forEach(function(v){try{var y=d,I=v.expandTo||k.expandTo,J=y.indexOf(v);if(I){try{var M=
            G(y,I,J);var K=g(y,I,J)}catch(P){throw P instanceof l&&h({part:v,rootError:P,postparsed:y,expandTo:I,index:J}),P;}var S=y.slice(K,J),Q=y.slice(J+1,M+1),N=k.getInner({index:J,part:v,leftParts:S,rightParts:Q,left:K,right:M,postparsed:y});N.length||(N.expanded=[S,Q],N=[N]);d=c([y.slice(0,K),N,y.slice(M+1)])}else d=y}catch(P){if(P instanceof l)u.push(P);else throw P;}});return{postparsed:d,errors:u}},getExpandToDefault:function(d,k,u){var v=d.slice(k[0].offset,k[1].offset),y=F(v);v=y.filter(function(K){return"/"===
            K.tag[1]}).length;var I=y.filter(function(K){K=K.tag;return"/"!==K[1]&&"/"!==K[K.length-2]}).length;if(v!==I)return{error:a({tag:k[0].part.value})};v=function(K,S){var Q=u[K],N=Q.contains,P=Q.expand;Q=Q.onlyTextInTag;if(z(N,y)){if(Q){Q=m(d,N,k[0].offset);var O=E(d,N,k[1].offset);if(null===Q||null===O)return"continue";O=n(d.slice(Q,O),function(ba){return t(N,ba)?"start":e(N,ba)?"end":null});if(2>=O.length)return"continue";Q=O[0];O=A(O);Q=Q.filter(q);O=O.filter(q);if(1!==Q.length||1!==O.length)return"continue"}return{v:{value:P}}}};
            I=0;for(var J=u.length;I<J;I++){var M=v(I,J);switch(M){case "continue":continue;default:if("object"===B(M))return M.v}}return!1}}},{"./doc-utils":4,"./errors":6}],23:[function(p,H,x){function B(C){function F(){var E={array:Array.prototype.slice.call(arguments)};E.array.shift();E.array.unshift(E.array[0]+E.array[1]);E.array.pop();var G=E.array.pop();E.offset=G;E.first=!0;C.matches.unshift(E)}-1===C.content.indexOf("<")&&-1===C.content.indexOf(">")&&C.content.replace(/^()([^<>]*)$/,F);var z=new RegExp("^()([^<]+)</(?:".concat(C.tagsXmlArrayJoined,
        ")>"));C.content.replace(z,F);z=new RegExp("(<(?:".concat(C.tagsXmlArrayJoined,")[^>]*>)([^>]+)$"));C.content.replace(z,function(){var E={array:Array.prototype.slice.call(arguments)};E.array.pop();var G=E.array.pop();E.offset=G;E.last=!0;-1===E.array[0].indexOf("/>")&&C.matches.push(E)});return C}var w=p("./doc-utils").pregMatchAll;H.exports=function(C,F){var z={};z.content=C;z.tagsXmlArray=F;z.tagsXmlArrayJoined=z.tagsXmlArray.join("|");var E=new RegExp("(?:(<(?:".concat(z.tagsXmlArrayJoined,")[^>]*>)([^<>]*)</(?:").concat(z.tagsXmlArrayJoined,
        ")>)|(<(?:").concat(z.tagsXmlArrayJoined,")[^>]*/>)"),"g");z.matches=w(E,z.content);return B(z)}},{"./doc-utils":4}],24:[function(p,H,x){function B(h){B="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return B(h)}function w(h,a){for(var d=0;d<a.length;d++){var k=a[d];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);
        Object.defineProperty(h,k.key,k)}}function C(h,a,d){a&&w(h.prototype,a);d&&w(h,d);return h}function F(h,a){var d=m(h,a).matches.map(function(k){return k.array[2]});return z(E(d.join("")))}x=p("./doc-utils");var z=x.wordToUtf8,E=x.convertSpaces,G=x.defaults,g=p("./scope-manager"),m=p("./xml-matcher");x=p("./errors");var c=x.throwMultiError,n=x.throwContentMustBeString,t=p("./lexer"),e=p("./parser.js"),q=p("./render.js"),A=p("./postrender.js"),l=p("./resolve.js");H.exports=function(){function h(a,d){if(!(this instanceof
        h))throw new TypeError("Cannot call a class as a function");this.filePath=d.filePath;this.modules=d.modules;this.fileTypeConfig=d.fileTypeConfig;Object.keys(G).map(function(k){this[k]=null!=d[k]?d[k]:G[k]},this);this.setModules({inspect:{filePath:this.filePath}});this.load(a)}C(h,[{key:"load",value:function(a){"string"!==typeof a&&n(B(a));this.content=a}},{key:"setTags",value:function(a){this.tags=null!=a?a:{};this.scopeManager=g({tags:this.tags,parser:this.parser});return this}},{key:"resolveTags",
        value:function(a){var d=this;this.tags=null!=a?a:{};this.scopeManager=g({tags:this.tags,parser:this.parser});a=this.getOptions();a.scopeManager=g(a);a.resolve=l;return l(a).then(function(k){return Promise.all(k.resolved.map(function(u){return Promise.resolve(u)})).then(function(u){d.setModules({inspect:{resolved:u}});return d.resolved=u})})}},{key:"getFullText",value:function(){return F(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(a){this.modules.forEach(function(d){d.set(a)})}},
        {key:"parse",value:function(){var a=[];this.xmllexed=t.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray});this.setModules({inspect:{xmllexed:this.xmllexed}});var d=t.parse(this.xmllexed,this.delimiters),k=d.lexed;a=a.concat(d.errors);this.lexed=k;this.setModules({inspect:{lexed:this.lexed}});this.parsed=e.parse(this.lexed,this.modules);this.setModules({inspect:{parsed:this.parsed}});d=e.postparse(this.parsed,this.modules);k=d.errors;this.postparsed=
                d.postparsed;this.setModules({inspect:{postparsed:this.postparsed}});a=a.concat(k);this.errorChecker(a);return this}},{key:"errorChecker",value:function(a){var d=this;a.length&&(this.modules.forEach(function(k){a=k.errorsTransformer(a)}),a.forEach(function(k){k.properties.file=d.filePath}),c(a))}},{key:"baseNullGetter",value:function(a,d){var k=this,u=this.modules.reduce(function(v,y){return null!=v?v:y.nullGetter(a,d,k)},null);return null!=u?u:this.nullGetter(a,d)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,
                tags:this.tags,modules:this.modules,parser:this.parser,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,linebreaks:this.linebreaks}}},{key:"render",value:function(a){this.filePath=a;a=this.getOptions();a.resolved=this.resolved;a.scopeManager=g(a);a.render=q;var d=q(a),k=d.parts;this.errorChecker(d.errors);this.content=A(k,a);this.setModules({inspect:{content:this.content}});return this}}]);return h}()},{"./doc-utils":4,"./errors":6,"./lexer":8,"./parser.js":16,"./postrender.js":17,
        "./render.js":19,"./resolve.js":20,"./scope-manager":21,"./xml-matcher":23}],25:[function(p,H,x){function B(c){this.options=c||{locator:{}}}function w(c,n,t){function e(l){var h=c[l];!h&&A&&(h=2==c.length?function(a){c(l,a)}:c);q[l]=h&&function(a){h("[xmldom "+l+"]\t"+a+z(t))}||function(){}}if(!c){if(n instanceof C)return n;c=n}var q={},A=c instanceof Function;t=t||{};e("warning");e("error");e("fatalError");return q}function C(){this.cdata=!1}function F(c,n){n.lineNumber=c.lineNumber;n.columnNumber=
        c.columnNumber}function z(c){if(c)return"\n@"+(c.systemId||"")+"#[line:"+c.lineNumber+",col:"+c.columnNumber+"]"}function E(c,n,t){return"string"==typeof c?c.substr(n,t):c.length>=n+t||n?new java.lang.String(c,n,t)+"":c}function G(c,n){c.currentElement?c.currentElement.appendChild(n):c.doc.appendChild(n)}B.prototype.parseFromString=function(c,n){var t=this.options,e=new g,q=t.domBuilder||new C,A=t.errorHandler,l=t.locator,h=t.xmlns||{},a={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};l&&q.setDocumentLocator(l);
        e.errorHandler=w(A,q,l);e.domBuilder=t.domBuilder||q;/\/x?html?$/.test(n)&&(a.nbsp="\u00a0",a.copy="\u00a9",h[""]="http://www.w3.org/1999/xhtml");h.xml=h.xml||"http://www.w3.org/XML/1998/namespace";c?e.parse(c,h,a):e.errorHandler.error("invalid doc source");return q.doc};C.prototype={startDocument:function(){this.doc=(new m).createDocument(null,null,null);this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(c,n,t,e){var q=this.doc;n=q.createElementNS(c,t||n);var A=e.length;
            G(this,n);this.currentElement=n;this.locator&&F(this.locator,n);for(var l=0;l<A;l++){c=e.getURI(l);var h=e.getValue(l);t=e.getQName(l);c=q.createAttributeNS(c,t);this.locator&&F(e.getLocator(l),c);c.value=c.nodeValue=h;n.setAttributeNode(c)}},endElement:function(c,n,t){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(c,n){},endPrefixMapping:function(c){},processingInstruction:function(c,n){var t=this.doc.createProcessingInstruction(c,n);this.locator&&F(this.locator,
            t);G(this,t)},ignorableWhitespace:function(c,n,t){},characters:function(c,n,t){if(c=E.apply(this,arguments)){var e=this.cdata?this.doc.createCDATASection(c):this.doc.createTextNode(c);this.currentElement?this.currentElement.appendChild(e):/^\s*$/.test(c)&&this.doc.appendChild(e);this.locator&&F(this.locator,e)}},skippedEntity:function(c){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(c){if(this.locator=c)c.lineNumber=0},comment:function(c,n,t){c=E.apply(this,arguments);
            var e=this.doc.createComment(c);this.locator&&F(this.locator,e);G(this,e)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(c,n,t){var e=this.doc.implementation;e&&e.createDocumentType&&(c=e.createDocumentType(c,n,t),this.locator&&F(this.locator,c),G(this,c))},warning:function(c){console.warn("[xmldom warning]\t"+c,z(this.locator))},error:function(c){console.error("[xmldom error]\t"+c,z(this.locator))},fatalError:function(c){console.error("[xmldom fatalError]\t"+
            c,z(this.locator));throw c;}};"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(c){C.prototype[c]=function(){return null}});var g=p("./sax").XMLReader,m=x.DOMImplementation=p("./dom").DOMImplementation;x.XMLSerializer=p("./dom").XMLSerializer;x.DOMParser=B},{"./dom":26,"./sax":27}],26:[function(p,H,x){function B(b,f){for(var r in b)f[r]=b[r]}function w(b,f){var r=b.prototype;
        if(Object.create){var D=Object.create(f.prototype);r.__proto__=D}r instanceof f||(D=function(){},D.prototype=f.prototype,D=new D,B(r,D),b.prototype=r=D);r.constructor!=b&&("function"!=typeof b&&console.error("unknow Class:"+b),r.constructor=b)}function C(b,f){if(f instanceof Error)var r=f;else r=this,Error.call(this,U[b]),this.message=U[b],Error.captureStackTrace&&Error.captureStackTrace(this,C);r.code=b;f&&(this.message=this.message+": "+f);return r}function F(){}function z(b,f){this._node=b;this._refresh=
        f;E(this)}function E(b){var f=b._node._inc||b._node.ownerDocument._inc;if(b._inc!=f){var r=b._refresh(b._node);ma(b,"length",r.length);B(r,b);b._inc=f}}function G(){}function g(b,f){for(var r=b.length;r--;)if(b[r]===f)return r}function m(b,f,r,D){D?f[g(f,D)]=r:f[f.length++]=r;b&&(r.ownerElement=b,f=b.ownerDocument)&&(D&&l(f,b,D),f&&f._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&(b._nsMap[r.prefix?r.localName:""]=r.value))}function c(b,f,r){var D=g(f,r);if(0<=D){for(var L=f.length-1;D<L;)f[D]=
        f[++D];f.length=L;b&&(f=b.ownerDocument)&&(l(f,b,r),r.ownerElement=null)}else throw C(va,Error(b.tagName+"@"+r));}function n(b){this._features={};if(b)for(var f in b)this._features=b[f]}function t(){}function e(b){return"<"==b&&"&lt;"||">"==b&&"&gt;"||"&"==b&&"&amp;"||'"'==b&&"&quot;"||"&#"+b.charCodeAt()+";"}function q(b,f){if(f(b))return!0;if(b=b.firstChild){do if(q(b,f))return!0;while(b=b.nextSibling)}}function A(){}function l(b,f,r,D){b&&b._inc++;"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&
    delete f._nsMap[r.prefix?r.localName:""]}function h(b,f,r){if(b&&b._inc)if(b._inc++,b=f.childNodes,r)b[b.length++]=r;else{f=f.firstChild;for(r=0;f;)b[r++]=f,f=f.nextSibling;b.length=r}}function a(b,f){var r=f.previousSibling,D=f.nextSibling;r?r.nextSibling=D:b.firstChild=D;D?D.previousSibling=r:b.lastChild=r;h(b.ownerDocument,b);return f}function d(b,f,r){var D=f.parentNode;D&&D.removeChild(f);if(f.nodeType===ha){D=f.firstChild;if(null==D)return f;var L=f.lastChild}else D=L=f;var V=r?r.previousSibling:
        b.lastChild;D.previousSibling=V;L.nextSibling=r;V?V.nextSibling=D:b.firstChild=D;null==r?b.lastChild=L:r.previousSibling=L;do D.parentNode=b;while(D!==L&&(D=D.nextSibling));h(b.ownerDocument||b,b);f.nodeType==ha&&(f.firstChild=f.lastChild=null);return f}function k(){this._nsMap={}}function u(){}function v(){}function y(){}function I(){}function J(){}function M(){}function K(){}function S(){}function Q(){}function N(){}function P(){}function O(){}function ba(b,f){var r=[],D=9==this.nodeType?this.documentElement:
        this,L=D.prefix,V=D.namespaceURI;if(V&&null==L&&(L=D.lookupPrefix(V),null==L))var da=[{namespace:V,prefix:null}];Z(this,r,b,f,da);return r.join("")}function T(b,f,r){f=b.prefix||"";b=b.namespaceURI;if(!f&&!b||"xml"===f&&"http://www.w3.org/XML/1998/namespace"===b||"http://www.w3.org/2000/xmlns/"==b)return!1;for(var D=r.length;D--;){var L=r[D];if(L.prefix==f)return L.namespace!=b}return!0}function Z(b,f,r,D,L){if(D)if(b=D(b)){if("string"==typeof b){f.push(b);return}}else return;switch(b.nodeType){case ca:L||
    (L=[]);var V=b.attributes,da=V.length,W=b.firstChild,oa=b.tagName;r="http://www.w3.org/1999/xhtml"===b.namespaceURI||r;f.push("<",oa);for(var ia=0;ia<da;ia++){var ea=V.item(ia);"xmlns"==ea.prefix?L.push({prefix:ea.localName,namespace:ea.value}):"xmlns"==ea.nodeName&&L.push({prefix:"",namespace:ea.value})}for(ia=0;ia<da;ia++){ea=V.item(ia);if(T(ea,r,L)){var ja=ea.prefix||"",na=ea.namespaceURI;f.push(ja?" xmlns:"+ja:" xmlns",'="',na,'"');L.push({prefix:ja,namespace:na})}Z(ea,f,r,D,L)}T(b,r,L)&&(ja=
        b.prefix||"",na=b.namespaceURI,f.push(ja?" xmlns:"+ja:" xmlns",'="',na,'"'),L.push({prefix:ja,namespace:na}));if(W||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(oa)){f.push(">");if(r&&/^script$/i.test(oa))for(;W;)W.data?f.push(W.data):Z(W,f,r,D,L),W=W.nextSibling;else for(;W;)Z(W,f,r,D,L),W=W.nextSibling;f.push("</",oa,">")}else f.push("/>");break;case pa:case ha:for(W=b.firstChild;W;)Z(W,f,r,D,L),W=W.nextSibling;break;case fa:return f.push(" ",b.name,'="',b.value.replace(/[<&"]/g,e),'"');case ka:return f.push(b.data.replace(/[<&]/g,
        e));case R:return f.push("<![CDATA[",b.data,"]]\x3e");case qa:return f.push("\x3c!--",b.data,"--\x3e");case ra:r=b.publicId;D=b.systemId;f.push("<!DOCTYPE ",b.name);r?(f.push(' PUBLIC "',r),D&&"."!=D&&f.push('" "',D),f.push('">')):D&&"."!=D?f.push(' SYSTEM "',D,'">'):((b=b.internalSubset)&&f.push(" [",b,"]"),f.push(">"));break;case sa:return f.push("<?",b.target," ",b.data,"?>");case aa:return f.push("&",b.nodeName,";");default:f.push("??",b.nodeName)}}function X(b,f,r){switch(f.nodeType){case ca:var D=
        f.cloneNode(!1);D.ownerDocument=b;case ha:break;case fa:r=!0}D||(D=f.cloneNode(!1));D.ownerDocument=b;D.parentNode=null;if(r)for(f=f.firstChild;f;)D.appendChild(X(b,f,r)),f=f.nextSibling;return D}function la(b,f,r){var D=new f.constructor;for(V in f){var L=f[V];"object"!=typeof L&&L!=D[V]&&(D[V]=L)}f.childNodes&&(D.childNodes=new F);D.ownerDocument=b;switch(D.nodeType){case ca:var V=f.attributes;var da=D.attributes=new G;L=V.length;da._ownerElement=D;for(da=0;da<L;da++)D.setAttributeNode(la(b,V.item(da),
        !0));break;case fa:r=!0}if(r)for(f=f.firstChild;f;)D.appendChild(la(b,f,r)),f=f.nextSibling;return D}function ma(b,f,r){b[f]=r}p={};var ca=p.ELEMENT_NODE=1,fa=p.ATTRIBUTE_NODE=2,ka=p.TEXT_NODE=3,R=p.CDATA_SECTION_NODE=4,aa=p.ENTITY_REFERENCE_NODE=5;H=p.ENTITY_NODE=6;var sa=p.PROCESSING_INSTRUCTION_NODE=7,qa=p.COMMENT_NODE=8,pa=p.DOCUMENT_NODE=9,ra=p.DOCUMENT_TYPE_NODE=10,ha=p.DOCUMENT_FRAGMENT_NODE=11,wa=p.NOTATION_NODE=12,Y={},U={};Y.INDEX_SIZE_ERR=(U[1]="Index size error",1);Y.DOMSTRING_SIZE_ERR=
        (U[2]="DOMString size error",2);var xa=Y.HIERARCHY_REQUEST_ERR=(U[3]="Hierarchy request error",3);Y.WRONG_DOCUMENT_ERR=(U[4]="Wrong document",4);Y.INVALID_CHARACTER_ERR=(U[5]="Invalid character",5);Y.NO_DATA_ALLOWED_ERR=(U[6]="No data allowed",6);Y.NO_MODIFICATION_ALLOWED_ERR=(U[7]="No modification allowed",7);var va=Y.NOT_FOUND_ERR=(U[8]="Not found",8);Y.NOT_SUPPORTED_ERR=(U[9]="Not supported",9);var ta=Y.INUSE_ATTRIBUTE_ERR=(U[10]="Attribute in use",10);Y.INVALID_STATE_ERR=(U[11]="Invalid state",
        11);Y.SYNTAX_ERR=(U[12]="Syntax error",12);Y.INVALID_MODIFICATION_ERR=(U[13]="Invalid modification",13);Y.NAMESPACE_ERR=(U[14]="Invalid namespace",14);Y.INVALID_ACCESS_ERR=(U[15]="Invalid access",15);C.prototype=Error.prototype;B(Y,C);F.prototype={length:0,item:function(b){return this[b]||null},toString:function(b,f){for(var r=[],D=0;D<this.length;D++)Z(this[D],r,b,f);return r.join("")}};z.prototype.item=function(b){E(this);return this[b]};w(z,F);G.prototype={length:0,item:F.prototype.item,getNamedItem:function(b){for(var f=
            this.length;f--;){var r=this[f];if(r.nodeName==b)return r}},setNamedItem:function(b){var f=b.ownerElement;if(f&&f!=this._ownerElement)throw new C(ta);f=this.getNamedItem(b.nodeName);m(this._ownerElement,this,b,f);return f},setNamedItemNS:function(b){var f=b.ownerElement;if(f&&f!=this._ownerElement)throw new C(ta);f=this.getNamedItemNS(b.namespaceURI,b.localName);m(this._ownerElement,this,b,f);return f},removeNamedItem:function(b){b=this.getNamedItem(b);c(this._ownerElement,this,b);return b},removeNamedItemNS:function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       f){var r=this.getNamedItemNS(b,f);c(this._ownerElement,this,r);return r},getNamedItemNS:function(b,f){for(var r=this.length;r--;){var D=this[r];if(D.localName==f&&D.namespaceURI==b)return D}return null}};n.prototype={hasFeature:function(b,f){var r=this._features[b.toLowerCase()];return r&&(!f||f in r)?!0:!1},createDocument:function(b,f,r){var D=new A;D.implementation=this;D.childNodes=new F;(D.doctype=r)&&D.appendChild(r);f&&(b=D.createElementNS(b,f),D.appendChild(b));return D},createDocumentType:function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      f,r){var D=new M;D.name=b;D.nodeName=b;D.publicId=f;D.systemId=r;return D}};t.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(b,f){return d(this,b,f)},replaceChild:function(b,f){this.insertBefore(b,f);f&&this.removeChild(f)},removeChild:function(b){return a(this,b)},appendChild:function(b){return this.insertBefore(b,null)},
        hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(b){return la(this.ownerDocument||this,this,b)},normalize:function(){for(var b=this.firstChild;b;){var f=b.nextSibling;f&&f.nodeType==ka&&b.nodeType==ka?(this.removeChild(f),b.appendData(f.data)):(b.normalize(),b=f)}},isSupported:function(b,f){return this.ownerDocument.implementation.hasFeature(b,f)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(b){for(var f=this;f;){var r=f._nsMap;if(r)for(var D in r)if(r[D]==
            b)return D;f=f.nodeType==fa?f.ownerDocument:f.parentNode}return null},lookupNamespaceURI:function(b){for(var f=this;f;){var r=f._nsMap;if(r&&b in r)return r[b];f=f.nodeType==fa?f.ownerDocument:f.parentNode}return null},isDefaultNamespace:function(b){return null==this.lookupPrefix(b)}};B(p,t);B(p,t.prototype);A.prototype={nodeName:"#document",nodeType:pa,doctype:null,documentElement:null,_inc:1,insertBefore:function(b,f){if(b.nodeType==ha){for(var r=b.firstChild;r;){var D=r.nextSibling;this.insertBefore(r,
            f);r=D}return b}null==this.documentElement&&b.nodeType==ca&&(this.documentElement=b);return d(this,b,f),b.ownerDocument=this,b},removeChild:function(b){this.documentElement==b&&(this.documentElement=null);return a(this,b)},importNode:function(b,f){return X(this,b,f)},getElementById:function(b){var f=null;q(this.documentElement,function(r){if(r.nodeType==ca&&r.getAttribute("id")==b)return f=r,!0});return f},createElement:function(b){var f=new k;f.ownerDocument=this;f.nodeName=b;f.tagName=b;f.childNodes=
            new F;return(f.attributes=new G)._ownerElement=f},createDocumentFragment:function(){var b=new N;b.ownerDocument=this;b.childNodes=new F;return b},createTextNode:function(b){var f=new y;f.ownerDocument=this;f.appendData(b);return f},createComment:function(b){var f=new I;f.ownerDocument=this;f.appendData(b);return f},createCDATASection:function(b){var f=new J;f.ownerDocument=this;f.appendData(b);return f},createProcessingInstruction:function(b,f){var r=new P;r.ownerDocument=this;r.tagName=r.target=
            b;r.nodeValue=r.data=f;return r},createAttribute:function(b){var f=new u;f.ownerDocument=this;f.name=b;f.nodeName=b;f.localName=b;f.specified=!0;return f},createEntityReference:function(b){var f=new Q;f.ownerDocument=this;f.nodeName=b;return f},createElementNS:function(b,f){var r=new k,D=f.split(":"),L=r.attributes=new G;r.childNodes=new F;r.ownerDocument=this;r.nodeName=f;r.tagName=f;r.namespaceURI=b;2==D.length?(r.prefix=D[0],r.localName=D[1]):r.localName=f;return L._ownerElement=r},createAttributeNS:function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 f){var r=new u,D=f.split(":");r.ownerDocument=this;r.nodeName=f;r.name=f;r.namespaceURI=b;r.specified=!0;2==D.length?(r.prefix=D[0],r.localName=D[1]):r.localName=f;return r}};w(A,t);k.prototype={nodeType:ca,hasAttribute:function(b){return null!=this.getAttributeNode(b)},getAttribute:function(b){return(b=this.getAttributeNode(b))&&b.value||""},getAttributeNode:function(b){return this.attributes.getNamedItem(b)},setAttribute:function(b,f){var r=this.ownerDocument.createAttribute(b);r.value=r.nodeValue=
            ""+f;this.setAttributeNode(r)},removeAttribute:function(b){(b=this.getAttributeNode(b))&&this.removeAttributeNode(b)},appendChild:function(b){if(b.nodeType===ha)return this.insertBefore(b,null);var f=b.parentNode;f&&f.removeChild(b);f=this.lastChild;b.parentNode=this;b.previousSibling=f;b.nextSibling=null;f?f.nextSibling=b:this.firstChild=b;this.lastChild=b;h(this.ownerDocument,this,b);return b},setAttributeNode:function(b){return this.attributes.setNamedItem(b)},setAttributeNodeNS:function(b){return this.attributes.setNamedItemNS(b)},
        removeAttributeNode:function(b){return this.attributes.removeNamedItem(b.nodeName)},removeAttributeNS:function(b,f){var r=this.getAttributeNodeNS(b,f);r&&this.removeAttributeNode(r)},hasAttributeNS:function(b,f){return null!=this.getAttributeNodeNS(b,f)},getAttributeNS:function(b,f){var r=this.getAttributeNodeNS(b,f);return r&&r.value||""},setAttributeNS:function(b,f,r){b=this.ownerDocument.createAttributeNS(b,f);b.value=b.nodeValue=""+r;this.setAttributeNode(b)},getAttributeNodeNS:function(b,f){return this.attributes.getNamedItemNS(b,
            f)},getElementsByTagName:function(b){return new z(this,function(f){var r=[];q(f,function(D){D===f||D.nodeType!=ca||"*"!==b&&D.tagName!=b||r.push(D)});return r})},getElementsByTagNameNS:function(b,f){return new z(this,function(r){var D=[];q(r,function(L){L===r||L.nodeType!==ca||"*"!==b&&L.namespaceURI!==b||"*"!==f&&L.localName!=f||D.push(L)});return D})}};A.prototype.getElementsByTagName=k.prototype.getElementsByTagName;A.prototype.getElementsByTagNameNS=k.prototype.getElementsByTagNameNS;w(k,t);u.prototype.nodeType=
        fa;w(u,t);v.prototype={data:"",substringData:function(b,f){return this.data.substring(b,b+f)},appendData:function(b){this.nodeValue=this.data=b=this.data+b;this.length=b.length},insertData:function(b,f){this.replaceData(b,0,f)},appendChild:function(b){throw Error(U[xa]);},deleteData:function(b,f){this.replaceData(b,f,"")},replaceData:function(b,f,r){var D=this.data.substring(0,b);b=this.data.substring(b+f);this.nodeValue=this.data=r=D+r+b;this.length=r.length}};w(v,t);y.prototype={nodeName:"#text",
        nodeType:ka,splitText:function(b){var f=this.data,r=f.substring(b);this.data=this.nodeValue=f=f.substring(0,b);this.length=f.length;b=this.ownerDocument.createTextNode(r);this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling);return b}};w(y,v);I.prototype={nodeName:"#comment",nodeType:qa};w(I,v);J.prototype={nodeName:"#cdata-section",nodeType:R};w(J,v);M.prototype.nodeType=ra;w(M,t);K.prototype.nodeType=wa;w(K,t);S.prototype.nodeType=H;w(S,t);Q.prototype.nodeType=aa;w(Q,t);N.prototype.nodeName=
        "#document-fragment";N.prototype.nodeType=ha;w(N,t);P.prototype.nodeType=sa;w(P,t);O.prototype.serializeToString=function(b,f,r){return ba.call(b,f,r)};t.prototype.toString=ba;try{if(Object.defineProperty){var ua=function(b){switch(b.nodeType){case ca:case ha:var f=[];for(b=b.firstChild;b;)7!==b.nodeType&&8!==b.nodeType&&f.push(ua(b)),b=b.nextSibling;return f.join("");default:return b.nodeValue}};Object.defineProperty(z.prototype,"length",{get:function(){E(this);return this.$$length}});Object.defineProperty(t.prototype,
        "textContent",{get:function(){return ua(this)},set:function(b){switch(this.nodeType){case ca:case ha:for(;this.firstChild;)this.removeChild(this.firstChild);(b||String(b))&&this.appendChild(this.ownerDocument.createTextNode(b));break;default:this.nodeValue=this.value=this.data=b}}});ma=function(b,f,r){b["$$"+f]=r}}}catch(b){}x.DOMImplementation=n;x.XMLSerializer=O},{}],27:[function(p,H,x){function B(){}function w(e,q,A,l,h){function a(R){var aa=R.slice(1,-1);if(aa in A)return A[aa];if("#"===aa.charAt(0))return R=
        parseInt(aa.substr(1).replace("x","0x")),65535<R?(R-=65536,R=String.fromCharCode(55296+(R>>10),56320+(R&1023))):R=String.fromCharCode(R),R;h.error("entity not found:"+R);return R}function d(R){if(R>M){var aa=e.substring(M,R).replace(/&#?\w+;/g,a);I&&k(M);l.characters(aa,0,R-M);M=R}}function k(R,aa){for(;R>=v&&(aa=y.exec(e));)u=aa.index,v=u+aa[0].length,I.lineNumber++;I.columnNumber=R-u+1}var u=0,v=0,y=/.*(?:\r\n?|\n)|.*$/g,I=l.locator;q=[{currentNSMap:q}];for(var J={},M=0;;){try{var K=e.indexOf("<",
        M);if(0>K){if(!e.substr(M).match(/^\s*$/)){var S=l.doc,Q=S.createTextNode(e.substr(M));S.appendChild(Q);l.currentElement=Q}break}K>M&&d(K);switch(e.charAt(K+1)){case "/":var N=e.indexOf(">",K+3),P=e.substring(K+2,N),O=q.pop();0>N?(P=e.substring(K+2).replace(/[\s<].*/,""),h.error("end tag name: "+P+" is not complete:"+O.tagName),N=K+1+P.length):P.match(/\s</)&&(P=P.replace(/[\s<].*/,""),h.error("end tag name: "+P+" maybe not complete"),N=K+1+P.length);var ba=O.localNSMap,T=O.tagName==P;if(T||O.tagName&&
        O.tagName.toLowerCase()==P.toLowerCase()){l.endElement(O.uri,O.localName,P);if(ba)for(var Z in ba)l.endPrefixMapping(Z);T||h.fatalError("end tag name: "+P+" is not match the current start tagName:"+O.tagName)}else q.push(O);N++;break;case "?":I&&k(K);N=m(e,K,l);break;case "!":I&&k(K);N=g(e,K,l,h);break;default:I&&k(K);var X=new c,la=q[q.length-1].currentNSMap;N=F(e,K,X,la,a,h);var ma=X.length;!X.closed&&G(e,N,X.tagName,J)&&(X.closed=!0,A.nbsp||h.warning("unclosed xml attribute"));if(I&&ma){for(var ca=
        C(I,{}),fa=0;fa<ma;fa++){var ka=X[fa];k(ka.offset);ka.locator=C(I,{})}l.locator=ca;z(X,l,la)&&q.push(X);l.locator=I}else z(X,l,la)&&q.push(X);"http://www.w3.org/1999/xhtml"!==X.uri||X.closed?N++:N=E(e,N,X.tagName,a,l)}}catch(R){h.error("element parse error: "+R),N=-1}N>M?M=N:d(Math.max(K,M)+1)}}function C(e,q){q.lineNumber=e.lineNumber;q.columnNumber=e.columnNumber;return q}function F(e,q,A,l,h,a){for(var d,k,u=++q,v=0;;){var y=e.charAt(u);switch(y){case "=":if(1===v)d=e.slice(q,u),v=3;else if(2===
        v)v=3;else throw Error("attribute equal must after attrName");break;case "'":case '"':if(3===v||1===v)if(1===v&&(a.warning('attribute value must after "="'),d=e.slice(q,u)),q=u+1,u=e.indexOf(y,q),0<u)k=e.slice(q,u).replace(/&#?\w+;/g,h),A.add(d,k,q-1),v=5;else throw Error("attribute value no end '"+y+"' match");else if(4==v)k=e.slice(q,u).replace(/&#?\w+;/g,h),A.add(d,k,q),a.warning('attribute "'+d+'" missed start quot('+y+")!!"),q=u+1,v=5;else throw Error('attribute value must after "="');break;
        case "/":switch(v){case 0:A.setTagName(e.slice(q,u));case 5:case 6:case 7:v=7,A.closed=!0;case 4:case 1:case 2:break;default:throw Error("attribute invalid close char('/')");}break;case "":return a.error("unexpected end of input"),0==v&&A.setTagName(e.slice(q,u)),u;case ">":switch(v){case 0:A.setTagName(e.slice(q,u));case 5:case 6:case 7:break;case 4:case 1:k=e.slice(q,u),"/"===k.slice(-1)&&(A.closed=!0,k=k.slice(0,-1));case 2:2===v&&(k=d);4==v?(a.warning('attribute "'+k+'" missed quot(")!!'),A.add(d,
            k.replace(/&#?\w+;/g,h),q)):("http://www.w3.org/1999/xhtml"===l[""]&&k.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+k+'" missed value!! "'+k+'" instead!!'),A.add(k,k,q));break;case 3:throw Error("attribute value missed!!");}return u;case "\u0080":y=" ";default:if(" ">=y)switch(v){case 0:A.setTagName(e.slice(q,u));v=6;break;case 1:d=e.slice(q,u);v=2;break;case 4:k=e.slice(q,u).replace(/&#?\w+;/g,h),a.warning('attribute "'+k+'" missed quot(")!!'),A.add(d,k,q);case 5:v=6}else switch(v){case 2:"http://www.w3.org/1999/xhtml"===
        l[""]&&d.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+d+'" missed value!! "'+d+'" instead2!!');A.add(d,d,q);q=u;v=1;break;case 5:a.warning('attribute space is required"'+d+'"!!');case 6:v=1;q=u;break;case 3:v=4;q=u;break;case 7:throw Error("elements closed character '/' and '>' must be connected to");}}u++}}function z(e,q,A){for(var l=e.tagName,h=null,a=e.length;a--;){var d=e[a],k=d.qName,u=d.value,v=k.indexOf(":");if(0<v){var y=d.prefix=k.slice(0,v);v=k.slice(v+1);y="xmlns"===
        y&&v}else v=k,y="xmlns"===k&&"";d.localName=v;if(!1!==y){if(null==h){h={};v=void 0;k=A;var I=A={};for(v in k)I[v]=k[v]}A[y]=h[y]=u;d.uri="http://www.w3.org/2000/xmlns/";q.startPrefixMapping(y,u)}}for(a=e.length;a--;)if(d=e[a],y=d.prefix)"xml"===y&&(d.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==y&&(d.uri=A[y||""]);v=l.indexOf(":");0<v?(y=e.prefix=l.slice(0,v),v=e.localName=l.slice(v+1)):(y=null,v=e.localName=l);a=e.uri=A[y||""];q.startElement(a,v,l,e);if(e.closed){if(q.endElement(a,v,l),
        h)for(y in h)q.endPrefixMapping(y)}else return e.currentNSMap=A,e.localNSMap=h,!0}function E(e,q,A,l,h){if(/^(?:script|textarea)$/i.test(A)){var a=e.indexOf("</"+A+">",q);e=e.substring(q+1,a);if(/[&<]/.test(e)){if(/^script$/i.test(A))return h.characters(e,0,e.length),a;e=e.replace(/&#?\w+;/g,l);h.characters(e,0,e.length);return a}}return q+1}function G(e,q,A,l){var h=l[A];null==h&&(h=e.lastIndexOf("</"+A+">"),h<q&&(h=e.lastIndexOf("</"+A)),l[A]=h);return h<q}function g(e,q,A,l){switch(e.charAt(q+
        2)){case "-":if("-"===e.charAt(q+3)){var h=e.indexOf("--\x3e",q+4);if(h>q)return A.comment(e,q+4,h-q-4),h+3;l.error("Unclosed comment")}break;default:if("CDATA["==e.substr(q+3,6))return h=e.indexOf("]]\x3e",q+9),A.startCDATA(),A.characters(e,q+9,h-q-9),A.endCDATA(),h+3;a:{l=[];h=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;h.lastIndex=q;for(h.exec(e);q=h.exec(e);)if(l.push(q),q[1]){h=l;break a}h=void 0}var a=h.length;if(1<a&&/!doctype/i.test(h[0][0]))return e=h[1][0],q=3<a&&/^public$/i.test(h[2][0])&&
        h[3][0],l=4<a&&h[4][0],h=h[a-1],A.startDTD(e,q&&q.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),A.endDTD(),h.index+h[0].length}return-1}function m(e,q,A){var l=e.indexOf("?>",q);return l&&(e=e.substring(q,l).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/))?(A.processingInstruction(e[1],e[2]),l+2):-1}function c(e){}function n(e,q){e.__proto__=q;return e}p=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;
        H=new RegExp("[\\-\\.0-9"+p.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");var t=new RegExp("^"+p.source+H.source+"*(?::"+p.source+H.source+"*)?$");B.prototype={parse:function(e,q,A){var l=this.domBuilder;l.startDocument();var h=q,a=q={},d;for(d in h)a[d]=h[d];w(e,q,A,l,this.errorHandler);l.endDocument()}};c.prototype={setTagName:function(e){if(!t.test(e))throw Error("invalid tagName:"+e);this.tagName=e},add:function(e,q,A){if(!t.test(e))throw Error("invalid attribute:"+e);this[this.length++]=
                {qName:e,value:q,offset:A}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};n({},n.prototype)instanceof n||(n=function(e,q){function A(){}A.prototype=q;A=new A;for(q in e)A[q]=e[q];return A});x.XMLReader=B},{}]},{},[])("/js/index.js")});